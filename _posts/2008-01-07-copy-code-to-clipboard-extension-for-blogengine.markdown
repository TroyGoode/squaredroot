--- 
layout: post
title: "BlogEngine Extension: Copy Code to Clipboard"
sharing: false
---

Since I first started this blog I've been using Colin Coller's [CopySourceAsHtml plugin](http://www.jtleigh.com/people/colin/software/CopySourceAsHtml/) for Visual Studio (which [Guy Burstein updated](http://blogs.microsoft.co.il/blogs/bursteg/archive/2007/11/21/copy-source-as-html-copysourceashtml-for-visual-studio-2008-rtm.aspx) for Visual Studio 2008's RTM). It was a nice little tool but as I started posting more and more code snippets to the blog I found myself wanting some additional features, specifically: 

* **Easy to use**. While it was perfectly simple to copy the source as html, it was a bit more cumbersome to paste it properly into [Windows Live Writer](http://get.live.com/writer/overview). I wound up in HTML mode in WLW everytime I needed to paste some code.
* **CSS support**. The Html generated by the VS plugin inlines all of the styles and makes it difficult to change the presentation of your code without tweaking the settings of the plugin at posting time.
* **Scrollable**. This is mostly handled by the above feature, but I wanted to be able to limit the amount of screen real estate taken up by the code while still allowing my readers to view more of the code without having to download any files.
* **Copyable**. Sometimes you see a piece of code that fits your situation perfectly, but when you copy it you wind up with a bunch of extra Html guck and line numbers at the front of every line you have to manually remove. I want to allow my readers to copy the code without any of that mess.

I found [syntaxhighlighter](http://code.google.com/p/syntaxhighlighter/) on Google Code pretty quickly and was impressed. I'd seen it around on other people's blogs and loved the "copy to clipboard" feature, but I really wanted a server-side (or pre-posting) highlighter that would take some of the strain off the browser and wanted something with richer WLW integration. 

After looking at a few more options I finally found [Leo Vildosola's Code Snippet](http://lvildosola.blogspot.com/2007/02/code-snippet-plugin-for-windows-live.html) plugin, which matched up with all of my requirements except for the lack of a built-in "copy to clipboard" feature. With some help from [clipboard copying javascript posted at WebChicanery](http://webchicanery.com/2006/11/14/clipboard-copy-javascript/) I set out to build an extension for [BlogEngine.net](http://www.dotnetblogengine.net/) that would automatically tack on the copy feature to any code I posted via the Code Snippet plugin. 

A few hours later, I present the CopyCodeToClipboard extension for BlogEngine.net! Below you will find an example of the extension displaying it's own code (mmm... dogfood) and the css I've used to style the code on my site. I've tried to make the extension css friendly so you can change it's presentation a great deal without modifying the code. 

[CopyCodeToClipboard.zip](/custom/files/old/CopyCodeToClipboard.zip)

Contains all of the below files in one convenient package. 

<hr>

[CopyCodeToClipboard.cs](/custom/files/old/CopyCodeToClipboard.cs)

This is the actual extension and should be placed into your root/App_Code/Extensions/ folder.

{% gist 4007483 CopyCodeToClipboard.cs %}

<hr>

[WLWSyntaxHighlighter.css](/custom/files/old/WLWSyntaxHighlighter.css)

The Css generated by the Windows Live Writer Code Snippet plugin, modified to fit into my blog's colors. 

{% gist 4007483 WLWSyntaxHighlighter.css %}

<hr>

[CopyCodeToClipboard.css](/custom/files/old/CopyCodeToClipboard.css)

The Css I use to style the little red tab below each code area. This is what you would change to match your blog. 

{% gist 4007483 CopyToClipboard.css %}

<hr>

[clipboard.swf](/custom/files/old/clipboard.swf)

A Macromedia Flash file used to circumvent Firefox & Safari's nasty habit of blocking javascript from interacting with the clipboard. Created (as best I can tell) by Mark O'Sullivan of [http://lussumo.com/](http://lussumo.com/" title="http://lussumo.com/). 

<hr>

**Update (July 11, 2008):**

A release of the Code Snippet plug hasn't been made since the last changes to its source was checked in (in late 2007), so I went ahead and downloaded & built the source. To install the plug place the two DLLs in the zip file from below into Windows Live Writer's /Plugins/ directory.

[CodeSnippetPlugin.zip](/custom/files/old/CodeSnippetPlugin.zip)